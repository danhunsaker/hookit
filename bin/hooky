#!/usr/bin/env ruby

MODULE_DIR = "/opt/local/hooky/mod"

hook = ARGV.shift

if not hook
  $stderr.puts "hook is required"
  exit 1
end

# uncomment if dev only
# lib = File.expand_path('../../lib', __FILE__)
# $LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)

require 'hooky'

include Hooky::Hook   # payload helpers
include Hooky::DSL    # awesome resource library

set :module_root, MODULE_DIR

# require hook libs
Dir.glob("#{MODULE_DIR}/lib/*.rb").each do |file|
  require file
end

begin 
  load "#{MODULE_DIR}/hooks/#{hook}.rb"
rescue LoadError
  $stderr.puts "hook: #{hook} does not exist"
end
